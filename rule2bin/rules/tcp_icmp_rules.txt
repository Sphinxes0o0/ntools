# TCP异常报文规则
alert tcp 192.168.1.10 1024:65535 -> 10.0.0.5 22 (msg:"TCP scan detected - connection from high port to SSH"; sid:1000010; rev:1;)
alert tcp any any -> 192.168.1.0/24 0:1024 (msg:"Possible inbound TCP port scan"; flags:S; sid:1000011; rev:1;)
alert tcp 10.10.10.10 any -> any 445 (msg:"Possible SMB scanning from known malicious IP"; sid:1000012; rev:1;)
alert tcp any any -> 172.16.0.0/16 135:139 (msg:"Possible RPC scanning"; flags:S; sid:1000013; rev:1;)
alert tcp any any -> 192.168.0.0/16 0 (msg:"TCP packet to reserved port 0"; sid:1000014; rev:1;)

# ICMP规则
alert icmp any any -> any any (msg:"Ping flood detected"; icode:0; itype:8; sid:1000020; rev:1;)
alert icmp any any -> 192.168.1.0/24 any (msg:"ICMP traffic to internal network"; sid:1000021; rev:1;)
alert icmp 10.0.0.0/8 any -> any any (msg:"ICMP from internal network to any destination"; sid:1000022; rev:1;)
alert icmp any any -> any any (msg:"Large ICMP packet detected"; dsize:>1024; sid:1000023; rev:1;)
alert icmp any any -> any any (msg:"ICMP redirect message"; itype:5; sid:1000024; rev:1;)
alert tcp 192.168.1.0/24 any -> 8.8.8.8 80 (msg:"MALWARE-CNC Win.Rootkit.Sednit variant outbound connection attempt"; content:"/search.php"; sid:40911; rev:1;)
alert tcp 192.168.1.0/24 any -> 8.8.8.8 31337 (msg:"MALWARE-CNC Linux.DDoS.D93 outbound connection"; content:"|4E 0F 42 07 27|"; sid:40991; rev:1;)
alert tcp 192.168.1.0/24 any -> 8.8.8.8 80 (msg:"MALWARE-CNC Win.Trojan.Locky variant outbound connection attempt"; content:"/admin.php"; sid:41334; rev:1;)
alert tcp 192.168.1.0/24 any -> 8.8.8.8 80 (msg:"MALWARE-CNC Win.Trojan.Locky variant outbound connection attempt"; content:"/checkupdate"; sid:41335; rev:2;)
alert tcp 192.168.1.0/24 any -> 8.8.8.8 80 (msg:"MALWARE-CNC Andr.Trojan.Sysch variant outbound connection attempt"; content:".do"; sid:41336; rev:1;)
alert tcp 192.168.1.0/24 any -> 8.8.8.8 80 (msg:"MALWARE-CNC Andr.Trojan.Sysch variant outbound connection attempt"; content:".do"; sid:41337; rev:1;)
alert tcp any any -> any 80 (msg:"HTTP traffic detected"; sid:1000001; rev:1;)
alert tcp 192.168.1.1 any -> any 443 (msg:"HTTPS from internal IP"; content:"GET"; sid:1000002; rev:1;)
alert udp any any -> any 53 (msg:"DNS traffic"; sid:1000003; rev:1;)
drop icmp any any -> any any (msg:"ICMP blocked"; sid:1000004; rev:1;)
log tcp 10.0.0.0/24 any -> any 22 (msg:"SSH from private network"; sid:1000005; rev:1;)